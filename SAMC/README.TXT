Enrico Fornasa, February 2026

Self-Assembly Monte Carlo (SAMC) sampling method.
Here, we present the code to sample ring-linear polymer blends using SAMC and to prepare the configurations for analysis.

===========================================================================================================================================

CONTENT
The directory "SAMC" should contain:
  - "SAMC_CODE" directory:
      functions.h -----------> header file with sampling functions
      functions.c -----------> functions implementation
      main.c ----------------> code for running the SAMC simulation
      launch_sampling.sh ----> script to launch SAMC simulation
      ran2.c ----------------> random number generator of "Numerical Recipes" by Press et al., for which the user must obtain a licensed copy.
  - "CHAIN_COORDINATES_CODE" directory:
      functions.h -----------> header file with functions to extract chain coordinates from edge-occupancy-encoded configurations
      functions.c -----------> functions implementation
      main.c ----------------> code for running chain coordinates extraction
      launch_sampling.sh ----> script to launch chain coordinates extraction code
  - "lattice_files" directory:
      lattice_50x50x50.dat --> data file with lattice elements (dimension, size, and list of sites, edges, nearest-neighbours)
  - "50x50x50_4linear" directory:
      INPUT_PARAMETERS.DAT --> input file with SAMC simulation parameters, that are:
        dimension -----------> lattice dimensionality (set to 3)
        size ----------------> length of lattice side (set to 50)
        n_linear_chains -----> number of linear chains (set to 4)
        n_dumps -------------> number of printings of the configurational state (i.e., number of configurations, set to 10) 
        n_steps_per_dump ----> number of Monte Carlo steps between two consecutive printings (set to 3 decorrelation times)

===========================================================================================================================================

EXECUTION
   Here, the user finds the list of commands to execute a SAMC simulation that generates 100 independent configurations for the system containing 4 linear chains on the 50x50x50 periodic lattice.

1) Run SAMC simulation. Configuration files will be produced in the directory "50x50x50_4linear/configurations/". Script's output will be written in file "50x50x50_4linear/log/log_sampling.txt"
   Enter the "SAMC_CODE" directory and execute the script "launch_sampling.sh":
      cd SAMC_CODE/
      bash ./launch_sampling.sh 50x50x50 4
      cd ..

2) Extract chain coordinates from (binary) configurations. Chain coordinates files will be produced in the directory "50x50x50_4linear/chain_coordinates/". Script's output will be written in file "50x50x50_4linear/log/log_chain_coordinates.txt"
   Enter "CHAIN_COORDINATES_CODE" directory and execute the script "launch_chain_coordinates.sh".
   The user can set how many configurations (number_of_configurations, e.g., 10) to analyze and from which to start (starting_configuration, e.g., 0).
      cd CHAIN_COORDINATES_CODE/
      bash launch_chain_coordinates.sh 50x50x50 4 0 10
      cd ..

===========================================================================================================================================

CONFIGURATIONS FORMAT
- Configuration files generated by SAMC simulations in the directory "50x50x50_4linear/configurations/" contain, in one single line, the edge-occupancy state as a binary string, followed by the end-points site indices.

- Configuration files with explicit chain coordinates, generated in the directory "50x50x50_4linear/chain_coordinates/", contain two types of chains:
    linear ---------> self-avoiding-walk with free endpoints
    ring -----------> closed self-avoiding-walk

    The file structure is sketched as follows:
      chain_type length
      site_index x y z
      site_index x y z
      ...

===========================================================================================================================================

FURTHER INFORMATIONS
- The "ran2.c" random number generator of "Numerical Recipes" by Press et al. is required to compile the SAMC code. Users must obtain their own licensed copy.
- Configurations are enumerated starting from 0.
- Lengths are expressed in terms of the number of bonds; linear chains consist of length+1 monomers.
